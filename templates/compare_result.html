{% extends "base.html" %}
{% block content %}
<div class="container">
    <div class="row justify-content-center">
        <div class="col-md-10">
            <a href="/recommend/recommend" class="btn btn-link mb-3 p-0 text-decoration-none text-muted">
                â† è¿”å›æ¨è–¦ç³»çµ±
            </a>

            <div class="card shadow-sm mb-4">
                <div class="card-body p-4 text-center">
                    <h3 class="mb-4">ğŸ“Š æˆåˆ†è‚¡é‡ç–Šåˆ†æå ±å‘Š</h3>
                    <div class="row align-items-center">
                        <div class="col-md-5">
                            <h4 class="text-primary">{{ etf1 }}</h4>
                        </div>
                        <div class="col-md-2">
                            <span class="h2 text-muted">VS</span>
                        </div>
                        <div class="col-md-5">
                            <h4 class="text-success">{{ etf2 }}</h4>
                        </div>
                    </div>

                    <div class="mt-4">
                        <p class="mb-2 fw-bold">åŠ æ¬Šé‡ç–Šæ¯”ä¾‹</p>
                        <div class="progress" style="height: 30px; border-radius: 15px;">
                            <div class="progress-bar progress-bar-striped progress-bar-animated 
                                {% if total_overlap > 40 %}bg-danger{% elif total_overlap > 20 %}bg-warning{% else %}bg-success{% endif %}" 
                                role="progressbar" 
                                style="width: {{ total_overlap }}%;" 
                                aria-valuenow="{{ total_overlap }}" aria-valuemin="0" aria-valuemax="100">
                                {{ total_overlap }}%
                            </div>
                        </div>
                    </div>

                    <div class="mt-4 p-3 rounded {% if total_overlap > 40 %}bg-light-danger{% elif total_overlap > 20 %}bg-light-warning{% else %}bg-light-success{% endif %}">
                        {% if total_overlap > 40 %}
                            <h5 class="text-danger">âš ï¸ è¨ºæ–·çµæœï¼šé«˜åº¦é‡ç–Š</h5>
                            <p class="mb-0 text-muted">é€™å…©æª” ETF çš„åº•å±¤æŒè‚¡éå¸¸ç›¸ä¼¼ã€‚è‹¥åŒæ™‚æŒæœ‰ï¼Œä¸€æ—¦æ ¸å¿ƒè‚¡ç¥¨ï¼ˆå¦‚å°ç©é›»ï¼‰ä¸‹è·Œï¼Œæ‚¨çš„è³‡ç”¢å°‡é¢è‡¨é›™å€è¡æ“Šï¼Œç„¡æ³•é”åˆ°åˆ†æ•£é¢¨éšªçš„æ•ˆæœã€‚</p>
                        {% elif total_overlap > 20 %}
                            <h5 class="text-warning">ğŸ”” è¨ºæ–·çµæœï¼šéƒ¨åˆ†é‡ç–Š</h5>
                            <p class="mb-0 text-muted">é€™å…©æª” ETF æœ‰ä¸€å®šçš„æŒè‚¡é‡åˆåº¦ã€‚å»ºè­°æª¢è¦–æ˜¯å¦ç¬¦åˆæ‚¨çš„é…ç½®ç­–ç•¥ï¼Œæˆ–è€…è€ƒæ…®æ­é…ä¸åŒç”¢æ¥­é¡åˆ¥çš„ ETFã€‚</p>
                        {% else %}
                            <h5 class="text-success">âœ… è¨ºæ–·çµæœï¼šåˆ†æ•£è‰¯å¥½</h5>
                            <p class="mb-0 text-muted">é€™å…©æª” ETF çš„é‡ç–Šåº¦æ¥µä½ï¼Œèƒ½å¤ æœ‰æ•ˆç™¼æ®äº’è£œä½œç”¨ï¼Œæ˜¯ä¸€å€‹å¥åº·çš„åˆ†æ•£æŠ•è³‡çµ„åˆã€‚</p>
                        {% endif %}
                    </div>
                </div>
            </div>

            <div class="card shadow-sm">
                <div class="card-header bg-white py-3">
                    <h5 class="mb-0 fw-bold">ğŸ” å…±åŒæŒæœ‰çš„æˆåˆ†è‚¡æ˜ç´°</h5>
                </div>
                <div class="card-body">
                    <table class="table table-hover align-middle">
                        <thead class="table-light">
                            <tr>
                                <th>æˆåˆ†è‚¡åç¨±</th>
                                <th>ä»£è™Ÿ</th>
                                <th>{{ etf1 }} ä½”æ¯”</th>
                                <th>{{ etf2 }} ä½”æ¯”</th>
                                <th>é‡ç–Šæ¬Šé‡ (Min)</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for stock in stocks %}
                            <tr>
                                <td><strong>{{ stock.stock_name }}</strong></td>
                                <td>{{ stock.stock_code }}</td>
                                <td>{{ stock.w1 }}%</td>
                                <td>{{ stock.w2 }}%</td>
                                <td class="text-primary fw-bold">
                                    {{ stock.w1 if stock.w1 < stock.w2 else stock.w2 }}%
                                </td>
                            </tr>
                            {% else %}
                            <tr>
                                <td colspan="5" class="text-center text-muted py-4">é€™å…©æª” ETF æ²’æœ‰é‡è¤‡çš„æˆåˆ†è‚¡ã€‚</td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
</div>

<style>
    .bg-light-danger { background-color: #fff5f5; border: 1px solid #feb2b2; }
    .bg-light-warning { background-color: #fffaf0; border: 1px solid #fbd38d; }
    .bg-light-success { background-color: #f0fff4; border: 1px solid #9ae6b4; }
</style>
{% endblock %}